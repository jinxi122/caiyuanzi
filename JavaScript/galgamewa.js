// Galgame文案数据
const galgameTexts = {
    // 章节1文案
    chapter1: {
        scene1: {
            character: "系统",
            sentences: [
                "你来到了一个神秘的菜园，这里种植着各种有生命的蔬菜。",
                "空气中弥漫着清新的泥土气息和蔬菜的芳香。",
                "突然，一个可爱的白菜精灵出现在你面前..."
            ],
            choices: [
                { text: "打招呼", next: 1, affection: 5 },
                { text: "静静观察", next: 2, affection: 2 }
            ]
        },
        scene2: {
            character: "白菜精灵 🥬",
            sentences: [
                "你好呀！我是这个菜园的守护者白菜精灵。",
                "你看起来是个有趣的人类呢！",
                "很少有外人会来到这个神秘的菜园..."
            ],
            choices: [
                { text: "询问菜园的秘密", next: 3, affection: 3 },
                { text: "询问白菜精灵的来历", next: 4, affection: 4 }
            ]
        },
        scene3: {
            character: "白菜精灵 🥬",
            sentences: [
                "（害羞地躲在一片大叶子后面）",
                "你...你在看什么呀？",
                "我脸上有什么东西吗？"
            ],
            choices: [
                { text: "称赞她很可爱", next: 5, affection: 8 },
                { text: "询问菜园的情况", next: 6, affection: 3 }
            ]
        }
    },
    
    // 章节2文案
    chapter2: {
        scene1: {
            character: "胡萝卜战士 🥕",
            sentences: [
                "站住！陌生人！",
                "我是菜园的守卫胡萝卜战士。",
                "说明你的来意！"
            ],
            choices: [
                { text: "表明友好意图", next: 1, affection: 4 },
                { text: "展示自己的实力", next: 2, affection: 2 }
            ]
        }
    },
    
    // 结局文案
    endings: {
        best: "恭喜！你与蔬菜们建立了深厚的友谊，成为了菜园的荣誉守护者！",
        good: "你与蔬菜们度过了愉快的时光，菜园的大门将永远为你敞开！",
        normal: "虽然相处时间不长，但蔬菜们会记得你这个特别的访客。"
    },
    
    // 游戏说明文案
    instructions: {
        title: "菜園子物語 - 游戏说明",
        content: [
            "• 通过选择不同的选项来推进剧情",
            "• 每个选择会影响角色的好感度", 
            "• 探索菜园的秘密，与蔬菜角色们建立友谊",
            "• 多个结局等待你的发现！"
        ],
        tip: "点击对话框或\"继续\"按钮显示下一句"
    },
    
    // 角色介绍文案
    characters: {
        "白菜精灵 🥬": {
            description: "菜园的守护者，性格活泼可爱，喜欢与人交流",
            personality: "天真烂漫，对新鲜事物充满好奇"
        },
        "胡萝卜战士 🥕": {
            description: "菜园的守卫，性格严肃认真，保护菜园安全",
            personality: "责任心强，对陌生人保持警惕"
        }
    }
};

// 获取文案的函数
function getGalgameText(chapter, scene) {
    return galgameTexts[`chapter${chapter}`]?.[`scene${scene}`];
}

function getEndingText(type) {
    return galgameTexts.endings[type] || galgameTexts.endings.normal;
}

function getInstructions() {
    return galgameTexts.instructions;
}

function getCharacterInfo(character) {
    return galgameTexts.characters[character];
}

/* 为兼容现有游戏逻辑，导出 storyData（与原来 galgame.js 中的 `story` 结构一致）
   这样 `galgame.js` 可以直接使用 `window.storyData` 来读取场景数组。 */
window.storyData = {
    1: [
        {
            character: "系统",
            image: "img/toxiang1 (1).png",
            sentences: [
                "菜园的夜像是一张古旧的旗帜，经过风雨却仍留着斑驳的纹理。你推开半掩的竹门，门轴发出一声低沉的呻吟，仿佛宣告着某种久远的秘密在静默中苏醒。月色从云隙间倾落，薄薄的光影漫过菜叶，露水在叶面上凝成晶点，犹如世间遗落的珍珠。泥土的气味带着远方的稻谷与柴火的余韵，混合出一种既熟悉又陌生的味道，使人不由得跟着呼吸，像是回到了被遗忘的小时候。",
                "在这个被夜色温柔包裹的地方，你脑中盘旋着祖母曾讲过的传说：很久以前，这片菜园被一群隐士守护，他们以蔬菜为名，守着一段与天地相连的誓约。誓约像一株深根的古树，将人间的粗粝与一点点温柔联结。如果誓约被打破，菜园便会现出它的另一面，风会变得尖利，叶片会在午夜发出低吟。祖母说那些被遗忘的人，会在菜园的边缘找到归处，而有些野心，则会被叶影吞没。"
                ,
                "今夜，你独自来到这里，脚步声在泥土上回荡，像是踏响了一段尚未完结的序章。走着走着，你听见了微弱的呻吟声，像是被风压低的呐喊。沿着声音，你从一片高大的芥菜与茄叶之间绕出，见到一个人卧在地上——衣衫褴褛，额间带血，呼吸匆促。他抬头看向你，眼里既有惊惧，也有一丝不可名状的恳求。月色在他的瞳孔中闪动，倒映出你自己的影子。",
                "那人自称尘行，言语里带着走江湖多年磨出的戾与倦。他说自己曾为名门弟子，因一场莫名的恩怨被迫离开师门，至此流离。在通往都城的路上，他目睹了一件关于菜园的旧物——一只古匣，匣内传言藏着一段关于守护者的旧约。有人因此而癫狂，想借古匣中的力量翻起旧日的权势，尘行因此被卷入追杀。",
                "你听他讲述，夜风像是把故事的细枝末节吹落在你的肩头。尘行说古匣并非凡器，它与菜园的某些禁忌有关，若被误用，祸乱将由此而起。你望着他胸前的血渍，思绪翻腾：这不过是救人，或是从此踏上一条无法回头的路？\n\n",
                "你的手在夜色中犹豫着。若伸出援手，你或许会卷入一场跨越数代的恩怨，或在揭示真相时发现曾被遗忘的人们的善与恶；若选择离开，可能保住短暂的安宁，却在未来的清晨被良知的轻击唤醒。乡间的老人曾说：‘真正的江湖，是由选择堆砌而成的。’你这一刻的决定，正是那一块重要的基石。",
                "在你犹疑间，远处的风铃发出清冷的一响，像是在问候也像是在审判。你俯身为尘行撕破衣片，按住伤口，能感觉到血液温热而真实。尘行的牙关紧咬着痛楚，声音却坚决：‘若你肯帮我，未来我必有回报；若不肯，我也不强求。’那句‘回报’在夜里飘得很远，像是一道尚未闭合的门。",
                "你牵着他的手，把他扶起，带着他走向村庄的隐蔽处。途中，风过菜行，像是在低诉：凡人心，终究难测。但你也看见了菜园里其他的微光：一只白菜的叶尖闪着柔和的光，那是守护者的气息。你隐约感到，这个故事不仅关于尘行，也关于你自己。",
                "数日的疗伤与交谈，让尘行渐渐露出过去的轮廓。他谈到师门的傲慢，与被迫离散的无奈，也谈到他在夜路上目睹的那些黑影。渐渐地，你发现事情比最初听来的更复杂——古匣牵连到地方权势、村落的旧恨，以及一段被掩埋的盟约。每一个名字都像一颗礁石，撞击出不易平息的波澜。",
                "在这段时间，你与尘行、白菜精灵等几位人物相识：白菜精灵以蔬叶为衣，话语清晰而直率；胡萝卜战士肩披旧甲，沉默而可靠。他们有各自的秘密，也有守护之志。你在与他们交往中，逐渐意识到，守护的意义并非单纯守住一件物品，而是守住一种记忆与秩序。",
                "古匣之事愈发显露出危险的轮廓。有人为了权势不择手段，甚至不惜动用旧日残存的秘术；有人则试图借用古匣博取名利，甚至做出背信弃义之事。菜园的平静被缓缓撕裂，叶脉间藏着不安。你必须在隐秘与公开之间做出选择，每一步都将影响未来的天平。",
                "于是，你与同伴制定计划：或暗中探查，或联署村民防护，或将古匣交付可靠之人。不同选择，将导致不同的结局：有的让村落免于纷争，却可能将权力交予不可靠的人；有的让事态激化，需以刀剑血腥来换取真相。你在多次商议后，发现所谓的‘正确’并非一目了然，更多时候是权衡利害后的不得已。",
                "在一次月黑风高之夜，你们潜入旧祠堂，那里供奉着与菜园有关的古老符物。墙壁上刻着数世流传的铭文，记载着守护者曾与村民立下的盟约。你在月光下读到一行字，字里仿佛夹带着风：‘守者以菜为命，民以守者为安。’这句古训像一把秤，衡量着每一个人的选择。",
                "然而，祠堂深处处处设伏，敌影突然暴起，刀光与烛影交错，你们被迫现身。战斗短促而惨烈，但也揭开了真相的一角：一名乡绅企图借古匣之名复兴旧势力，他收买人心、散播谣言，以图重掌乡中权柄。此人曾在若干年前与守护者有过交恶，旧怨未了，今欲借权势复仇。",
                "面对这样的敌人，你开始明白，所谓的守护并非只关乎一处祠堂或一只匣子，而是关乎一整片土地上人们的信任与记忆。你的每一次选择，都会像种子一般埋在这片土里，未来或发芽或枯萎。",
                "夜色在战争过后渐渐平息，露水也将血迹与泥土的气息洗刷。你与同伴们负伤返回，菜园的叶尖在晨光中颤抖。尘行对你微微一笑，那笑里有感激，也有对未来的未卜。你摸着腰间的护符，内心清楚：真正的考验，才刚刚开始。",
                "若问归处何在，你将发现答案不是一个地点，而是你用行动搭建的信任与选择。菜园会记住每一个愿意守护它的人，而有些秘密，会在时间里慢慢释然。此刻，你站在晨雾与菜叶之间，听见远处的鸡鸣，远方的路仍旧漫长，但脚下的每一步，已经不再是孤独的徘徊。"
            ],
            choices: [
                { text: "上前救助尘行", next: 1, affection: 3 },
                { text: "离开，怕惹麻烦", next: 2, affection: -1 }
            ]
        },
        {
            character: "尘行",
            image: "img/toxiang1 (2).png",
            sentences: [
                "他被你扶起，声音虽虚弱，却带着不肯屈服的倔强：‘若你肯一助，江湖上有恩当以身相报。’\n\n尘行向你讲述了半月前的遭遇：在通往都城的路上，他无意间目睹了一樽被盗的古匣，而被匪徒误认为知情者，随后遭到追杀。古匣里所藏的，乃是一段关于菜园旧事的秘密——有人意欲借此旧事翻起一场血雨。",
                "你听着他的述说，意识到眼前的选择或许不再只是救一人，而可能决定一个隐秘世代的归宿。"
            ],
            choices: [
                { text: "陪同调查古匣的来历", next: 3, affection: 4 },
                { text: "先带他去村庄隐蔽处养伤", next: 4, affection: 1 }
            ]
        },
        {
            character: "旁观者",
            image: "img/toxiang1 (3).png",
            sentences: [
                "你选择离开，回到小路上，夜色把你的身影拉得很长。几日后，你在市集听闻有关于尘行的传闻：他独自一人闯入祠堂，揭开了陈年旧案的部分真相，结果却损失惨重。你在某个无人的黄昏，忽然怀念那一刻若干可能的不同。"
            ],
            choices: [
                { text: "悔恨未助，回头寻他", next: 1, affection: -2 },
                { text: "继续自己的路，保持平凡", next: 5, affection: 0 }
            ]
        },
        {
            character: "盟友：白菜精灵",
            image: "img/toxiang1 (4).png",
            sentences: [
                "你与尘行一同前往菜园深处的古祠。祠堂门楣雕刻着蔬菜与武器交织的纹样，仿佛在诉说着一段被人遗忘的盟约。\n\n在祠堂角落，守护者——一位名为‘白菜精灵’的存在现身，她的目光清澈，像是能看穿人心。她告诉你，古匣所牵扯的并非一件凡物，而是与菜园守护者有关的古老誓约，若落入凡人之手，将招来祸根。",
                "你们联手调查，逐渐靠近真相，但也被更深的秘密所牵扯。"
            ],
            choices: [
                { text: "与白菜精灵合力守护古匣", next: 7, affection: 6 },
                { text: "偷偷窃取古匣以求私利", next: 6, affection: -5 }
            ]
        },
        {
            character: "庇护者",
            image: "img/toxiang1 (5).png",
            sentences: [
                "你将尘行带往村中一处隐蔽小屋，替他疗伤。几日后，他恢复了些许气色，眼神中多了信任。尘行说：‘有些事需要时间，风会把真相吹到对的地方。’你开始思索自己在这一连串事件中的位置。"
            ],
            choices: [
                { text: "留在村中与尘行并肩", next: 3, affection: 2 },
                { text: "独自出发，寻找自己的答案", next: 5, affection: 0 }
            ]
        },
        {
            character: "决断",
            image: "img/toxiang1 (6).png",
            sentences: [
                "事态愈发紧张，追索古匣的人们开始现身，祠堂外刀光交错。你与伙伴们不得不选一个立场：守护，还是放手？每一次抉择都在心里刻下一道新痕。最终，无论结局如何，你都将记住今夜，记住菜园与那段被尘封的誓言。"
            ],
            choices: [
                { text: "守护古匣，迎来对抗", next: 8, affection: 8 },
                { text: "将古匣交予官府，求一时平安", next: 9, affection: 1 }
            ]
        },
        {
            character: "叛离者",
            image: "img/toxiang1 (7).png",
            sentences: [
                "你选择私利之道，独占古匣。短暂的富贵之后，随之而来的是不信与孤独。夜半时分，你听得到背后潜行者的脚步，也听得到那份曾经的良知在冷风中颤抖。"
            ],
            choices: [
                { text: "自责悔过，归还古匣", next: 6, affection: -3 },
                { text: "继续隐秘，守住成果", next: 9, affection: -6 }
            ]
        },
        {
            character: "守护之战",
            image: "img/toxiang1 (8).png",
            sentences: [
                "你与伙伴们选择迎战。月光下，兵刃相接，菜叶被踢碎，露珠化作血色的光点。战斗残酷，却也让人明白守护的价值。最终，你们揭露了幕后之人——一位妄图借古匣复苏旧势力的乡绅。正义与牺牲交织，结局因你的抉择而不同。"
            ],
            choices: [
                { text: "继续闯荡江湖", next: 10, affection: 10 },
                { text: "归隐菜园", next: 11, affection: 4 }
            ]
        },
        {
            character: "交付官府",
            image: "img/toxiang1 (9).png",
            sentences: [
                "你将古匣交由衙门，求得一时的平安。官府将古匣收走，但谁也无法保证权力清廉。若无来自民间的守护，古匣的秘密也可能在冷漠中再次被误用。你在回程中，常常怀念那一刻的选择与其后果。"
            ],
            choices: [
                { text: "继续生活", next: 11, affection: 0 },
                { text: "重新寻找真相", next: 3, affection: 2 }
            ]
        }
        ,
        {
            character: "隐匿者",
            image: "img/toxiang1 (10).png",
            sentences: [
                "你选择将古匣藏匿于暗处，暂时守住了它带来的利益与秘密。然而夜深人静时，良知如寒风般在心头掠过，孤独与不安慢慢堆积。有人开始怀疑你的动机，亦有人暗中窥探你所守之物。",
                "日子久了，你发现所谓的收获并未换来内心的安稳。那些曾经的诺言与信任，在利益面前摇摇欲坠。你开始思索：保有古匣，究竟为何而守？"
            ],
            choices: [
                { text: "自责悔过，归还古匣", next: 6, affection: -3 },
                { text: "继续隐秘，守住成果", next: 11, affection: -6 }
            ]
        },
        {
            character: "英雄结局",
            image: "img/toxiang1 (11).png",
            sentences: [
                "你与伙伴们在守护之战中力挽狂澜，斩断了乡绅的阴谋。此役过后，你的名声在乡间与邻里间传开，人们以你为楷模，称颂你的勇气与正直。尽管代价不小，然而你在心中明白：守护有时需要付出。",
                "在众人的景仰与纷扰中，你选择继续行走江湖，帮助更多有难之人，成为传说中一位默默付出的义士。"
            ],
            choices: [
                // 将“继续闯荡江湖”改为进入下一章的触发（设置为本章长度）
                { text: "继续闯荡江湖", next: 12, affection: 10 },
                { text: "归隐田园，享受平静", next: 11, affection: 4 }
            ]
        },
        {
            character: "归隐菜园",
            image: "img/toxiang1 (3).png",
            sentences: [
                "尘世的喧嚣渐渐远去，你选择把古匣交予值得信任的守护者或深埋于菜园的地底。菜园恢复了它原有的宁静，日子慢慢回到耕作与收获的节奏。你在田间重新栽种希望，学会以平和的心面对过去的纷争。",
                "有时你仍会在月下独行，回想当初的那些选择，而每一次回想都让你更加确认：守护不是占有，而是让生活可以继续。"
            ],
            choices: [
                { text: "重新开始", next: 0, affection: 0 }
            ]
        }
    ],
    2: [
        {
            character: "旅途篇——相逢",
            image: "img/toxiang1 (12).png",
            sentences: [
                "若你选择继续，故事并未就此终止。你一路随尘行踏入更远的土地，遇见了形形色色的人：为信念而战的侠客、为利益翻云覆雨的商贾、以及在夜市中弹琴的老人。每一次交错，都会将你的心性打磨得更加清晰。",
                "在行旅中，你发现菜园的秘密不过是众多纠葛的一角；真正的考验，是你在利害面前能否守住初心。"
            ],
            choices: [
                { text: "与尘行并肩闯荡", next: 1, affection: 3 },
                { text: "独自修行，寻求人心之道", next: 2, affection: 2 }
            ]
        },
        {
            character: "旅途篇——修行",
            image: "img/toxiang1 (13).png",
            sentences: [
                "你选择独自修行，半年之后，你的身形变得稳重如山，内心也多了不易动摇的沉静。有人会因为你的沉稳而侧目，有人则会因为你不争而敬重。修行让你更能看清恩怨背后的缘由。",
                "在某个晨曦，你再次回想起菜园里的那把古匣，心中生出新的念头：或许真正的守护并不在于占有，而在于理解与传承。"
            ],
            choices: [
                { text: "回到菜园，作为守护者", next: 3, affection: 5 },
                { text: "踏上未知旅途", next: 4, affection: 1 }
            ]
        },
        {
            character: "路遇侠客",
            image: "img/toxiang1 (5).png",
            sentences: [
                "在一处山道，你遇见一位独行侠。他面色沉静，提及当年与守护者的交往，言辞间有未了之事。",
                "侠客提出一个试炼：若你能在三日内完成他所交付的小事，便可获得一件能帮助你查访古匣线索的信物。"
            ],
            choices: [
                { text: "接受试炼", next: 5, affection: 2 },
                { text: "婉拒，继续自身修行", next: 2, affection: 0 }
            ]
        },
        {
            character: "市集的耳闻",
            image: "img/zhangguonv.png",
            sentences: [
                "你回到市集，听闻有人在暗中交易与古匣有关的情报。一条线索指向了某位常年往来的商贾。",
                "是否前往打探，或继续追随尘行的脚步？"
            ],
            choices: [
                { text: "打探商贾", next: 6, affection: 1 },
                { text: "继续随行", next: 7, affection: 1 }
            ]
        },
        {
            character: "未知旅途",
            image: "img/toxiang1 (9).png",
            sentences: [
                "你选择踏上未知旅途，途经荒野与小镇。风尘仆仆中，你见识到不同的人心与世态。",
                "旅途教会了你更谦卑地看待他人的苦难与选择。"
            ],
            choices: [
                { text: "在路途中休整", next: 7, affection: 1 },
                { text: "继续深入追查古匣", next: 6, affection: 2 }
            ]
        },
        {
            character: "试炼之地",
            image: "img/toxiang1 (11).png",
            sentences: [
                "试炼并非血刃，而是一次关乎信任与判断的考验。你需在邻里之间调停一场误会，以换取侠客所说的线索。",
                "调停成功后，你获得一张被撕弃的地图碎片，地图上标注了可能藏匣之处的一角。"
            ],
            choices: [
                { text: "拼凑线索前往标注处", next: 8, affection: 3 },
                { text: "将线索交予尘行共同研判", next: 7, affection: 1 }
            ]
        },
        {
            character: "追查商贾",
            image: "img/luohua.png",
            sentences: [
                "商贾一开始闭口不谈，但在你的恳切与观察下，他流露出恐惧与悔意。他透露曾为一名乡绅运送过一只匣子，随后便被吩咐闭口。",
                "你得到更多线索：这只匣子很可能曾被短暂藏匿于祠堂的僻处。"
            ],
            choices: [
                { text: "返回祠堂一探究竟", next: 8, affection: 2 },
                { text: "与尘行联手搜寻", next: 7, affection: 1 }
            ]
        },
        {
            character: "夜探祠堂",
            image: "img/toxiang1 (3).png",
            sentences: [
                "你与同伴们悄入祠堂，月光下的雕刻令你心生敬畏。最终在一处隐匿的地板下，你找到了几件陈旧的小物与一片残缺的铭文，似乎印证了古匣的历史。",
                "发现让人振奋，但也意味更高的风险正在向你们靠近。"
            ],
            choices: [
                { text: "将发现上报给守护者", next: 9, affection: 2 },
                { text: "暂时隐匿，避免引火上身", next: 10, affection: -1 }
            ]
        },
        {
            character: "联手揭露",
            image: "img/toxiang1 (7).png",
            sentences: [
                "你与尘行、白菜精灵联手，将发现公之于众，一时间村中议论纷纷。有人支持你们的做法，也有人对暴露旧事感到不安。",
                "你们的行动使得乡绅的阴谋加速崩解，但也招来了更为危险的抉择：是否将古匣交予外人或继续守护。"
            ],
            choices: [
                { text: "将线索交予善意的官府", next: 11, affection: 0 },
                { text: "继续守护并隐藏匣子下落", next: 10, affection: 3 }
            ]
        },
        {
            character: "隐匿与代价",
            image: "img/toxiang1 (8).png",
            sentences: [
                "你选择将发现暂时隐藏，这样一来，古匣的下落依旧被少数人掌握。宁静换来了难言的代价，有人因此心生不满。",
                "时间会检验这个决定是否明智。"
            ],
            choices: [
                { text: "继续隐秘守护", next: 11, affection: 1 },
                { text: "悔改并公示线索", next: 9, affection: -1 }
            ]
        }
    ],
    3: [
        {
            character: "终章——归处",
            image: "img/toxiang1 (11).png",
            sentences: [
                "多年之后，菜园依旧，岁月在叶间写下细密的纹理。你或为人所称道，或隐于田野，但无论结局如何，那些曾经的选择早已在生命中生根发芽。",
                "有些秘密终会被阳光照亮，有些伤痕则需用温柔与时间细心疗愈。你望向曾经走过的路，明白了守护的真意：不是占有，而是让生命得以被记得。"
            ],
            choices: [
                { text: "继续守护菜园", next: 1, affection: 3 },
                { text: "离开江湖，归隐田园", next: 2, affection: 1 }
            ]
        },
        {
            character: "暮年守护",
            image: "img/toxiang3.png",
            sentences: [
                "你选择留下，与新一代守护者一同教导村民与行旅者关于守护的意义。菜园又生出新的嫩叶，生命在循环中延续。",
                "那些曾经的纷争成为了后来人讲述的故事，犹如篝火旁的回忆。"
            ],
            choices: [
                { text: "重新开始冒险", next: 0, affection: 0 },
                { text: "安度晚年", next: 0, affection: 0 }
            ]
        },
        {
            character: "孤旅终章",
            image: "img/toxiang1 (2).png",
            sentences: [
                "你选择离开江湖，走上自己的路。路途寂寥但自由，你在远方留下了名字，也带走了一些安静的希望。",
                "风继续吹，菜园在背后默默生长，而你的故事在某个村落被低声传唱。"
            ],
            choices: [
                { text: "重新开始", next: 0, affection: 0 }
            ]
        }
    ]
};